(function(t){function e(e){for(var n,s,o=e[0],c=e[1],u=e[2],v=0,p=[];v<o.length;v++)s=o[v],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(p.length)p.shift()();return r.push.apply(r,u||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,o=1;o<i.length;o++){var c=i[o];0!==a[c]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={app:0},r=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("cd49")},"0045":function(t,e,i){"use strict";var n=i("9275"),a=i.n(n);a.a},"021a":function(t,e,i){"use strict";var n=i("964e"),a=i.n(n);a.a},"0499":function(t,e,i){"use strict";var n=i("eee0"),a=i.n(n);a.a},"0b4b":function(t,e,i){},"0d65":function(t,e,i){},"137d":function(t,e,i){},"152a":function(t,e,i){"use strict";var n=i("db29"),a=i.n(n);a.a},"18c9":function(t,e,i){},"1b80":function(t,e,i){"use strict";var n=i("e10b"),a=i.n(n);a.a},"1d00":function(t,e,i){},"1f42":function(t,e,i){"use strict";var n=i("e7df"),a=i.n(n);a.a},"2cd4":function(t,e,i){"use strict";var n=i("c6e9"),a=i.n(n);a.a},"2d46":function(t,e,i){},"2f1c":function(t,e,i){"use strict";var n=i("6dab"),a=i.n(n);a.a},"31b7":function(t,e,i){},3407:function(t,e,i){},3959:function(t,e,i){"use strict";var n=i("4516"),a=i.n(n);a.a},"3d5a":function(t,e,i){"use strict";var n=i("57b1"),a=i.n(n);a.a},"40bb":function(t,e,i){"use strict";var n=i("0b4b"),a=i.n(n);a.a},"40bf":function(t,e,i){"use strict";var n=i("b154"),a=i.n(n);a.a},4282:function(t,e,i){},4516:function(t,e,i){},"487b":function(t,e,i){"use strict";var n=i("5e2e"),a=i.n(n);a.a},4987:function(t,e,i){},"4bbc":function(t,e,i){"use strict";var n=i("5b3d"),a=i.n(n);a.a},"4f2c":function(t,e,i){"use strict";var n=i("b46d"),a=i.n(n);a.a},5273:function(t,e,i){"use strict";var n=i("7b15"),a=i.n(n);a.a},"541f":function(t,e,i){"use strict";var n=i("c5c3"),a=i.n(n);a.a},"55e8":function(t,e,i){"use strict";var n=i("82bc"),a=i.n(n);a.a},"57b1":function(t,e,i){},"58ad":function(t,e,i){},"5a73":function(t,e,i){"use strict";var n=i("c2f9"),a=i.n(n);a.a},"5b3d":function(t,e,i){},"5e2e":function(t,e,i){},"5e6c":function(t,e,i){"use strict";var n=i("4987"),a=i.n(n);a.a},6065:function(t,e,i){},"687e":function(t,e,i){"use strict";var n=i("31b7"),a=i.n(n);a.a},"69f6":function(t,e,i){"use strict";var n=i("fecf"),a=i.n(n);a.a},"6dab":function(t,e,i){},7181:function(t,e,i){},7360:function(t,e,i){"use strict";var n=i("fde6"),a=i.n(n);a.a},"73ce":function(t,e,i){"use strict";var n=i("d364"),a=i.n(n);a.a},"7b15":function(t,e,i){},"82bc":function(t,e,i){},8384:function(t,e,i){},"854b":function(t,e,i){"use strict";var n=i("4282"),a=i.n(n);a.a},8926:function(t,e,i){"use strict";var n=i("137d"),a=i.n(n);a.a},8946:function(t,e,i){},"8d14":function(t,e,i){},9275:function(t,e,i){},"964e":function(t,e,i){},9848:function(t,e,i){"use strict";var n=i("b7f5"),a=i.n(n);a.a},"9c23":function(t,e,i){"use strict";var n=i("0d65"),a=i.n(n);a.a},"9d14":function(t,e,i){"use strict";var n=i("eaaa"),a=i.n(n);a.a},a526:function(t,e,i){"use strict";var n=i("fa0b"),a=i.n(n);a.a},aacf:function(t,e,i){"use strict";var n=i("8d14"),a=i.n(n);a.a},b154:function(t,e,i){},b46d:function(t,e,i){},b5d4:function(t,e,i){},b7f5:function(t,e,i){},bcd4:function(t,e,i){},c0fa:function(t,e,i){},c276:function(t,e,i){"use strict";var n=i("2d46"),a=i.n(n);a.a},c2f9:function(t,e,i){},c340:function(t,e,i){},c5c3:function(t,e,i){},c62f:function(t,e,i){"use strict";var n=i("c340"),a=i.n(n);a.a},c6e9:function(t,e,i){},cba3:function(t,e,i){"use strict";var n=i("bcd4"),a=i.n(n);a.a},cc3d:function(t,e,i){"use strict";var n=i("3407"),a=i.n(n);a.a},cd49:function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n,a=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"header"},[i("div",{staticClass:"container"},[i("div",{staticClass:"wrapper"},[i("div",{staticClass:"header"},[i("site-header")],1),i("div",{staticClass:"menu"},[i("main-menu")],1)])])]),i("div",{staticClass:"content"},[i("div",{staticClass:"container"},[i("router-view")],1)]),i("notifications",{staticClass:"notifications"})],1)},s=[],o=i("276c"),c=i("e954"),u=i("2c4c"),l=i("920b"),v=i("92a6"),p=i("9ab4"),d=i("1b40"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"notifications"},t._l(t.notifications,(function(e){return i("li",{key:e.id,staticClass:"notification",class:[e.class,t.shouldHide(e)?"hide":""]},[i("div",{staticClass:"text"},[t._v(" "+t._s(e.text)+" ")]),e.extra?i("div",{staticClass:"extra"},[t._v(" "+t._s(e.extra)+" ")]):t._e()])})),0)},h=[],b=(i("4de4"),i("a434"),n=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.notifications=[],t}return Object(c["a"])(i,[{key:"mounted",value:function(){var t=this;this.$root.$on(n.notificationEvent,(function(e){t.notifications.splice(0,0,e)})),this.intervalID=window.setInterval(this.processErrors,100)}},{key:"destroyed",value:function(){window.clearInterval(this.intervalID)}},{key:"shouldHide",value:function(t){var e=this.duration(new Date,t.created);return e>n.visibilityDuration}},{key:"processErrors",value:function(){var t=this;this.notifications=this.notifications.filter((function(e){var i=t.duration(new Date,e.created);return i<n.visibilityDuration+n.animationDuration}))}},{key:"duration",value:function(t,e){return(t.getTime()-e.getTime())/1e3}}],[{key:"pushError",value:function(t,e,i){var n=i&&i.response&&i.response.data&&i.response.data.message?i.response.data.message:null,a={id:this.notificationId++,class:"error",created:new Date,text:e,extra:n};t.$root.$emit(this.notificationEvent,a)}},{key:"pushSuccess",value:function(t,e){var i={id:this.notificationId++,class:"success",created:new Date,text:e,extra:null};t.$root.$emit(this.notificationEvent,i)}}]),i}(d["d"]));b.notificationEvent="eggplant_notification",b.notificationId=0,b.visibilityDuration=10,b.animationDuration=2,b=n=Object(p["a"])([d["a"]],b);var m=b,y=m,g=(i("2cd4"),i("2877")),O=Object(g["a"])(y,f,h,!1,null,"fa2d66b2",null),j=O.exports,k=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("router-link",{staticClass:"site-header",attrs:{to:{name:"browse"}}},[i("i",{staticClass:"fas fa-bicycle"})])},w=[],C=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);C=Object(p["a"])([d["a"]],C);var _,S=C,x=S,U=(i("3d5a"),Object(g["a"])(x,k,w,!1,null,"0ee48e32",null)),P=U.exports,E=(i("d3b7"),i("bc3a")),$=i.n(E),D=i("fc11"),I=i("2f62");a["a"].use(I["a"]),function(t){t["SetUser"]="setUser"}(_||(_={}));var A,z=new I["a"].Store({state:{user:void 0},mutations:Object(D["a"])({},_.SetUser,(function(t,e){t.user=e}))}),M=i("a78e"),F=i.n(M),T="auth-token",Z=function(){function t(){Object(o["a"])(this,t)}return Object(c["a"])(t,[{key:"storeToken",value:function(t){F.a.set(T,t)}},{key:"clearToken",value:function(){F.a.remove(T)}},{key:"getToken",value:function(){return F.a.get(T)}}]),t}(),R="Access-Token",N=function(){function t(e){var i=this;Object(o["a"])(this,t),this.vue=e,this.axios=$.a.create(),this.authService=new Z,this.axios.interceptors.request.use((function(t){var e=i.authService.getToken();return e&&(t.headers[R]=e),t}),(function(t){return Promise.reject(t)})),this.axios.interceptors.response.use((function(t){return t}),(function(t){return t.response&&401===t.response.status&&(i.authService.clearToken(),i.vue.$store.commit(_.SetUser,null)),Promise.reject(t)}))}return Object(c["a"])(t,[{key:"setup",value:function(){var t="setup";return this.axios.get("/api/"+t)}},{key:"getActivity",value:function(t){var e="activities/".concat(t);return this.axios.get("/api/"+e)}},{key:"getUser",value:function(t){var e="users/".concat(t);return this.axios.get("/api/"+e)}},{key:"getUserActivities",value:function(t,e,i){var n="users/".concat(t,"/activities");return this.axios.get("/api/"+n,{params:this.getUserActivitiesParams(e,i)})}},{key:"initialize",value:function(t){var e="auth/register-initial";return this.axios.post("/api/"+e,t)}},{key:"login",value:function(t){var e=this,i="auth/login";return new Promise((function(n,a){e.axios.post("/api/"+i,t).then((function(t){e.authService.storeToken(t.data.token),e.refreshCurrentUser().then((function(){n()}),(function(t){a(t)}))}),(function(t){a(t)}))}))}},{key:"newActivity",value:function(t){var e=new FormData;e.set("routeFile",t.routeFile),e.set("title",t.title),e.set("visibility",t.visibility);var i="activities";return this.axios.post("/api/"+i,e)}},{key:"editActivity",value:function(t,e){var i="activities/".concat(t);return this.axios.put("/api/"+i,e)}},{key:"deleteActivity",value:function(t){var e="activities/".concat(t);return this.axios.delete("/api/"+e)}},{key:"newPrivacyZone",value:function(t){var e="privacy-zones";return this.axios.post("/api/"+e,t)}},{key:"deletePrivacyZone",value:function(t){var e="privacy-zones/".concat(t);return this.axios.delete("/api/"+e)}},{key:"getUserPrivacyZones",value:function(t){var e="users/".concat(t,"/privacy-zones");return this.axios.get("/api/"+e)}},{key:"logout",value:function(){var t=this,e="auth/logout";return new Promise((function(i,n){t.axios.post("/api/"+e).then((function(){t.authService.clearToken(),t.vue.$store.commit(_.SetUser,null),i()}),(function(t){n(t)}))}))}},{key:"refreshCurrentUser",value:function(){var t=this,e="auth";return new Promise((function(i,n){t.axios.get("/api/"+e).then((function(e){t.vue.$store.commit(_.SetUser,e.data),i(e.data)}),(function(t){t.response&&401===t.response.status?i(null):n(t)}))}))}},{key:"register",value:function(t){var e="auth/register";return this.axios.post("/api/"+e,t)}},{key:"list",value:function(){var t="auth/users";return this.axios.get("/api/"+t)}},{key:"createInvitation",value:function(){var t="auth/create-invitation";return this.axios.post("/api/"+t)}},{key:"remove",value:function(t){t=encodeURIComponent(t);var e="auth/users/".concat(t);return this.axios.delete("/api/"+e)}},{key:"updateProfile",value:function(t,e){t=encodeURIComponent(t);var i="auth/users/".concat(t);return this.axios.put("/api/"+i,e)}},{key:"importStrava",value:function(t){var e=new FormData;e.set("archive",t.archive);var i="import/strava";return this.axios.post("/api/"+i,e)}},{key:"getUserActivitiesParams",value:function(t,e){if(t&&e)throw new Error("defined both before and after");return t?{before:t}:e?{after:e}:null}}]),t}(),L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-menu"},[i("ul",[i("li",{staticClass:"element-nav"},[i("ul",{staticClass:"nav"},[t.user?i("li",[i("router-link",{attrs:{to:t.newActivityLink}},[t._v(" New activity ")])],1):t._e(),t.user?i("li",[i("router-link",{attrs:{to:t.profileLink}},[t._v(" Profile ")])],1):t._e()])]),i("li",[i("current-user")],1)])])},q=[],H=(i("ac1f"),i("5319"),function(){function t(e){Object(o["a"])(this,t),this.vue=e}return Object(c["a"])(t,[{key:"escapeHome",value:function(){this.vue.$router.replace({name:"browse"})}},{key:"getBrowse",value:function(){return{name:"browse"}}},{key:"getSettings",value:function(){return{name:"settings"}}},{key:"getSettingsProfile",value:function(){return{name:"settings-profile"}}},{key:"getSettingsPrivacyZones",value:function(){return{name:"settings-privacy-zones"}}},{key:"getSettingsImport",value:function(){return{name:"settings-import"}}},{key:"getSettingsInstance",value:function(){return{name:"settings-instance"}}},{key:"getProfile",value:function(t){return{name:"profile",params:{username:t}}}},{key:"getProfileWithBefore",value:function(t,e){return{name:"profile",params:{username:t},query:{before:e}}}},{key:"getProfileWithAfter",value:function(t,e){return{name:"profile",params:{username:t},query:{after:e}}}},{key:"getActivity",value:function(t){return{name:"activity",params:{activityUUID:t}}}},{key:"getActivitySettings",value:function(t){return{name:"activity-settings",params:{activityUUID:t}}}},{key:"getNewPrivacyZone",value:function(){return{name:"new-privacy-zone"}}},{key:"getPrivacyZoneSettings",value:function(t){return{name:"privacy-zone-settings",params:{privacyZoneUUID:t}}}},{key:"getNewActivity",value:function(){return{name:"new-activity"}}}]),t}()),B=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"current-user"},[t.loading?i("div",[i("spinner")],1):t._e(),!t.loading&&t.user?i("dropdown",{ref:"dropdown",on:{click:t.settings},scopedSlots:t._u([{key:"trigger",fn:function(){return[i("span",[i("i",{staticClass:"far fa-user-circle"})]),i("span",[t._v(" "+t._s(t.user.displayName)+" ")]),i("i",{staticClass:"fas fa-caret-down"})]},proxy:!0},{key:"content",fn:function(){return[i("dropdown-element",[i("router-link",{staticClass:"menu-element",attrs:{to:t.toProfile},nativeOn:{click:function(e){return t.dropdown.close(e)}}},[t._v(" You are signed in as @"+t._s(t.user.username)+". ")])],1),i("dropdown-divider"),i("dropdown-element",[i("router-link",{staticClass:"menu-element highlight",attrs:{to:t.profileLink},nativeOn:{click:function(e){return t.dropdown.close(e)}}},[t._v(" Profile ")])],1),i("dropdown-element",[i("router-link",{staticClass:"menu-element highlight",attrs:{to:t.settingsLink},nativeOn:{click:function(e){return t.dropdown.close(e)}}},[t._v(" Settings ")])],1),i("dropdown-element",[i("a",{staticClass:"menu-element highlight",on:{click:t.logout}},[t._v(" Sign out ")])])]},proxy:!0}],null,!1,2794748364)}):t._e(),t.loading||t.user?t._e():i("ul",[i("li",[i("a",{on:{click:t.login}},[t._v(" Sign in ")])]),i("li",[i("a",{on:{click:t.register}},[t._v(" Sign up ")])])])],1)},V=[],W=A=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.notifications=[],t}return Object(c["a"])(i,[{key:"mounted",value:function(){var t=this;this.$root.$on(A.notificationEvent,(function(e){t.notifications.splice(0,0,e)})),this.intervalID=window.setInterval(this.processErrors,100)}},{key:"destroyed",value:function(){window.clearInterval(this.intervalID)}},{key:"shouldHide",value:function(t){var e=this.duration(new Date,t.created);return e>A.visibilityDuration}},{key:"processErrors",value:function(){var t=this;this.notifications=this.notifications.filter((function(e){var i=t.duration(new Date,e.created);return i<A.visibilityDuration+A.animationDuration}))}},{key:"duration",value:function(t,e){return(t.getTime()-e.getTime())/1e3}}],[{key:"pushError",value:function(t,e,i){var n=i&&i.response&&i.response.data&&i.response.data.message?i.response.data.message:null,a={id:this.notificationId++,class:"error",created:new Date,text:e,extra:n};t.$root.$emit(this.notificationEvent,a)}},{key:"pushSuccess",value:function(t,e){var i={id:this.notificationId++,class:"success",created:new Date,text:e,extra:null};t.$root.$emit(this.notificationEvent,i)}}]),i}(d["d"]);W.notificationEvent="eggplant_notification",W.notificationId=0,W.visibilityDuration=10,W.animationDuration=2,W=A=Object(p["a"])([d["a"]],W);var G=W,Y=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},J=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spinner"},[i("i",{staticClass:"fas fa-circle-notch fa-spin"})])}],K=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);K=Object(p["a"])([d["a"]],K);var Q=K,X=Q,tt=(i("aacf"),Object(g["a"])(X,Y,J,!1,null,"5bbc4aac",null)),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dropdown"},[t.isOpen?i("div",{staticClass:"close-overlay",on:{click:t.close}}):t._e(),i("div",{staticClass:"wrapper"},[i("a",{staticClass:"trigger",on:{click:t.open}},[t._t("trigger")],2),t.isOpen?i("div",{staticClass:"arrow"}):t._e(),t.isOpen?i("ul",{staticClass:"content"},[t._t("content")],2):t._e()])])},nt=[],at=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.isOpen=!1,t}return Object(c["a"])(i,[{key:"open",value:function(){this.isOpen=!0}},{key:"close",value:function(){this.isOpen=!1}}]),i}(d["d"]);at=Object(p["a"])([d["a"]],at);var rt=at,st=rt,ot=(i("9c23"),Object(g["a"])(st,it,nt,!1,null,"dd0dd85e",null)),ct=ot.exports,ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"dropdown-element"},[t._t("default")],2)},lt=[],vt=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);vt=Object(p["a"])([d["a"]],vt);var pt=vt,dt=pt,ft=(i("ee62"),Object(g["a"])(dt,ut,lt,!1,null,"35969062",null)),ht=ft.exports,bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"dropdown-divider"})},mt=[],yt=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);yt=Object(p["a"])([d["a"]],yt);var gt=yt,Ot=gt,jt=(i("1f42"),Object(g["a"])(Ot,bt,mt,!1,null,"c65ccd08",null)),kt=jt.exports,wt=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.logoutInProgress=!1,t.navigationService=new H(Object(u["a"])(t)),t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"login",value:function(){this.$router.push({name:"login",query:{next:window.location.pathname}})}},{key:"register",value:function(){this.$router.push({name:"register",query:{next:window.location.pathname}})}},{key:"settings",value:function(){this.$router.push({name:"settings"})}},{key:"logout",value:function(){var t=this;this.logoutInProgress=!0,this.apiService.logout().then((function(){t.dropdown.close()}),(function(e){G.pushError(t,"There was an error during the sign out process.",e)})).finally((function(){return t.logoutInProgress=!1}))}},{key:"loading",get:function(){return void 0===this.user}},{key:"user",get:function(){return this.$store.state.user}},{key:"toProfile",get:function(){return this.navigationService.getProfile(this.user.username)}},{key:"profileLink",get:function(){return this.navigationService.getProfile(this.user.username)}},{key:"settingsLink",get:function(){return this.navigationService.getSettings()}}]),i}(d["d"]);Object(p["a"])([Object(d["c"])("dropdown")],wt.prototype,"dropdown",void 0),wt=Object(p["a"])([Object(d["a"])({components:{Spinner:et,Dropdown:ct,DropdownElement:ht,DropdownDivider:kt}})],wt);var Ct=wt,_t=Ct,St=(i("152a"),Object(g["a"])(_t,B,V,!1,null,"1c8d5d02",null)),xt=St.exports,Ut=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"user",get:function(){return this.$store.state.user}},{key:"newActivityLink",get:function(){return this.navigationService.getNewActivity()}},{key:"profileLink",get:function(){return this.navigationService.getProfile(this.user.username)}}]),i}(d["d"]);Ut=Object(p["a"])([Object(d["a"])({components:{CurrentUser:xt}})],Ut);var Pt=Ut,Et=Pt,$t=(i("cba3"),Object(g["a"])(Et,L,q,!1,null,"b01d7c48",null)),Dt=$t.exports,It=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.errCheckSetup="Could not confirm whether this instance's setup process was completed.",t.errCheckUser="Could not retrieve the current user.",t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"created",value:function(){this.redirectToSetupIfNeeded(),this.loadCurrentUser()}},{key:"redirectToSetupIfNeeded",value:function(){var t=this;this.apiService.setup().then((function(e){e.data.completed||t.$router.push({name:"setup"})}),(function(e){j.pushError(t,t.errCheckSetup,e)}))}},{key:"loadCurrentUser",value:function(){var t=this;this.apiService.refreshCurrentUser().catch((function(e){j.pushError(t,t.errCheckUser,e)}))}}]),i}(d["d"]);It=Object(p["a"])([Object(d["a"])({components:{Notifications:j,SiteHeader:P,MainMenu:Dt}})],It);var At=It,zt=At,Mt=(i("9d14"),Object(g["a"])(zt,r,s,!1,null,null,null)),Ft=Mt.exports,Tt=i("8c4f"),Zt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Rt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"browse"},[i("div",{staticClass:"wrapper"},[t._v(" Welcome! ")])])}],Nt=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Nt=Object(p["a"])([d["a"]],Nt);var Lt=Nt,qt=Lt,Ht=(i("2f1c"),Object(g["a"])(qt,Zt,Rt,!1,null,"363807f5",null)),Bt=Ht.exports,Vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"initialize"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Create an administrator account"}}),i("div",{staticClass:"center"},[i("form",[i("form-input",{attrs:{type:"text",placeholder:"Username",icon:"fas fa-user"},on:{submit:t.submit},model:{value:t.cmd.username,callback:function(e){t.$set(t.cmd,"username",e)},expression:"cmd.username"}}),i("form-input",{attrs:{type:"password",placeholder:"Password",icon:"fas fa-key"},on:{submit:t.submit},model:{value:t.cmd.password,callback:function(e){t.$set(t.cmd,"password",e)},expression:"cmd.password"}}),i("app-button",{attrs:{text:"Proceed",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1)])],1)])},Wt=[],Gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("h1",{staticClass:"main-header"},[i("div",{staticClass:"text"},[t._v(t._s(t.text))]),i("div",{staticClass:"slot"},[t._t("default")],2)])},Yt=[],Jt=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],Jt.prototype,"text",void 0),Jt=Object(p["a"])([d["a"]],Jt);var Kt=Jt,Qt=Kt,Xt=(i("8926"),Object(g["a"])(Qt,Gt,Yt,!1,null,"7d95f4f2",null)),te=Xt.exports,ee=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"subheader"},[i("div",{staticClass:"text"},[t._v(t._s(t.text))]),i("div",{staticClass:"line"})])},ie=[],ne=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],ne.prototype,"text",void 0),ne=Object(p["a"])([d["a"]],ne);var ae=ne,re=ae,se=(i("0499"),Object(g["a"])(re,ee,ie,!1,null,"1b676b41",null)),oe=se.exports,ce=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-input"},[t.icon?i("div",{staticClass:"icon"},[i("i",{class:t.icon})]):t._e(),i("input",{attrs:{type:t.type,placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)},keydown:t.onKeyDown}})])},ue=[],le=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return Object(c["a"])(i,[{key:"onKeyDown",value:function(t){"Enter"===t.key&&this.$emit("submit")}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],le.prototype,"type",void 0),Object(p["a"])([Object(d["b"])()],le.prototype,"placeholder",void 0),Object(p["a"])([Object(d["b"])()],le.prototype,"value",void 0),Object(p["a"])([Object(d["b"])()],le.prototype,"maxlength",void 0),Object(p["a"])([Object(d["b"])()],le.prototype,"icon",void 0),le=Object(p["a"])([d["a"]],le);var ve=le,pe=ve,de=(i("d8fc"),Object(g["a"])(pe,ce,ue,!1,null,"3bf517aa",null)),fe=de.exports,he=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"app-button",class:{disabled:t.disabled,working:t.working},on:{click:t.onClick}},[t.working?t._e():i("span",[t._v(t._s(t.text))]),t.working?i("spinner"):t._e()],1)},be=[],me=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return Object(c["a"])(i,[{key:"onClick",value:function(t){this.disabled||this.working||this.$emit("click",t)}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],me.prototype,"text",void 0),Object(p["a"])([Object(d["b"])()],me.prototype,"disabled",void 0),Object(p["a"])([Object(d["b"])()],me.prototype,"working",void 0),Object(p["a"])([Object(d["b"])()],me.prototype,"type",void 0),me=Object(p["a"])([Object(d["a"])({components:{Spinner:et}})],me);var ye=me,ge=ye,Oe=(i("fd9b"),Object(g["a"])(ge,he,be,!1,null,"59d015a9",null)),je=Oe.exports,ke=function t(){Object(o["a"])(this,t)},we=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.cmd=new ke,t.working=!1,t.errLogin="Initial setup succeeded but the automatic login failed.",t.errSetup="Error performing the initial setup.",t.errCheckSetup="Could not confirm whether this instance's setup process was completed.",t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"mounted",value:function(){this.redirectAwayIfNeeded()}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.apiService.initialize(this.cmd).then((function(){var e={username:t.cmd.username,password:t.cmd.password};t.apiService.login(e).then((function(){t.working=!1,t.$router.replace({name:"browse"})}),(function(e){t.working=!1,G.pushError(t,t.errLogin,e)}))}),(function(e){t.working=!1,G.pushError(t,t.errSetup,e)})))}},{key:"redirectAwayIfNeeded",value:function(){var t=this;this.apiService.setup().then((function(e){e.data.completed&&t.$router.replace({name:"browse"})}),(function(e){G.pushError(t,t.errCheckSetup,e)}))}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.cmd.username||t.push("Username can not be empty."),this.cmd.password||t.push("Password can not be empty."),t}}]),i}(d["d"]);we=Object(p["a"])([Object(d["a"])({components:{MainHeader:te,SubHeader:oe,FormInput:fe,AppButton:je}})],we);var Ce=we,_e=Ce,Se=(i("0045"),Object(g["a"])(_e,Vt,Wt,!1,null,"addd9674",null)),xe=Se.exports,Ue=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Sign in"}}),i("div",{staticClass:"center"},[i("form",[i("form-input",{attrs:{type:"text",placeholder:"Username",icon:"fas fa-user"},on:{submit:t.submit},model:{value:t.cmd.username,callback:function(e){t.$set(t.cmd,"username",e)},expression:"cmd.username"}}),i("form-input",{attrs:{type:"password",placeholder:"Password",icon:"fas fa-key"},on:{submit:t.submit},model:{value:t.cmd.password,callback:function(e){t.$set(t.cmd,"password",e)},expression:"cmd.password"}}),i("app-button",{attrs:{text:"Sign in",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1)])],1)])},Pe=[],Ee=function t(){Object(o["a"])(this,t)},$e=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.cmd=new Ee,t.working=!1,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){t&&this.navigationService.escapeHome()}},{key:"submit",value:function(){var t=this;if(this.formValid){this.working=!0;var e=this.getNext();this.apiService.login(this.cmd).then((function(){e?t.$router.replace({path:e}):t.navigationService.escapeHome()}),(function(e){G.pushError(t,"Sign in process could not be completed.",e)})).finally((function(){t.working=!1}))}}},{key:"getNext",value:function(){var t=this.$route.query.next;return Array.isArray(t)?t.length>0?t[0]:null:t}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.cmd.username||t.push("Username can not be empty."),this.cmd.password||t.push("Password can not be empty."),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],$e.prototype,"onUserChanged",null),$e=Object(p["a"])([Object(d["a"])({components:{MainHeader:te,FormInput:fe,AppButton:je}})],$e);var De=$e,Ie=De,Ae=(i("854b"),Object(g["a"])(Ie,Ue,Pe,!1,null,"905be200",null)),ze=Ae.exports,Me=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"register"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Sign up"}}),i("div",{staticClass:"center"},[t.canAttemptToRegister?t._e():i("span",[t._v(" Registration is operating in invitation-only mode. Contact the owner of this instance to register. ")]),t.canAttemptToRegister?i("form",[i("form-input",{attrs:{type:"text",placeholder:"Username",icon:"fas fa-user"},on:{submit:t.submit},model:{value:t.cmd.username,callback:function(e){t.$set(t.cmd,"username",e)},expression:"cmd.username"}}),i("form-input",{attrs:{type:"password",placeholder:"Password",icon:"fas fa-key"},on:{submit:t.submit},model:{value:t.cmd.password,callback:function(e){t.$set(t.cmd,"password",e)},expression:"cmd.password"}}),i("app-button",{attrs:{text:"Sign up",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1):t._e()])],1)])},Fe=[],Te=function t(){Object(o["a"])(this,t)},Ze=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.cmd=new Te,t.working=!1,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t.errLogin="Sign up succeeded but the automatic login failed.",t.errSignUp="Error during the sign up process.",t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){t&&this.navigationService.escapeHome()}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.cmd.token=this.$route.params.token,this.apiService.register(this.cmd).then((function(){var e={username:t.cmd.username,password:t.cmd.password};t.apiService.login(e).then((function(){t.working=!1,t.navigationService.escapeHome()}),(function(e){t.working=!1,G.pushError(t,t.errLogin,e)}))}),(function(e){t.working=!1,G.pushError(t,t.errSignUp,e)})))}},{key:"canAttemptToRegister",get:function(){return!!this.$route.params.token}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.cmd.username||t.push("Username can not be empty."),this.cmd.password||t.push("Password can not be empty."),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],Ze.prototype,"onUserChanged",null),Ze=Object(p["a"])([Object(d["a"])({components:{MainHeader:te,FormInput:fe,AppButton:je}})],Ze);var Re=Ze,Ne=Re,Le=(i("e2de"),Object(g["a"])(Ne,Me,Fe,!1,null,"29e7e3ac",null)),qe=Le.exports,He=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings-profile"},[i("settings-page",{attrs:{name:"profile"}},[i("sub-header",{attrs:{text:"Profile"}}),t.cmd?i("form",{staticClass:"profile-form"},[i("form-input",{attrs:{type:"text",placeholder:"Display name",icon:"fas fa-pen",maxlength:"100"},model:{value:t.cmd.displayName,callback:function(e){t.$set(t.cmd,"displayName",e)},expression:"cmd.displayName"}}),i("app-button",{attrs:{text:"Save profile",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1):t._e()],1)],1)},Be=[],Ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings-page"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Settings"}}),i("div",{staticClass:"nav-wrapper"},[i("div",{staticClass:"nav"},[i("ul",[i("li",{class:{active:"profile"===t.name}},[i("router-link",{attrs:{to:t.linkProfile}},[t._v(" Profile ")])],1),i("li",{class:{active:"privacy-zones"===t.name}},[i("router-link",{attrs:{to:t.linkPrivacyZones}},[t._v(" Privacy zones ")])],1),i("li",{class:{active:"import"===t.name}},[i("router-link",{attrs:{to:t.linkImport}},[t._v(" Import ")])],1),i("li",{class:{active:"instance"===t.name}},[i("router-link",{attrs:{to:t.linkInstance}},[t._v(" Instance ")])],1)])]),i("div",{staticClass:"content"},[t._t("default")],2)])],1)])},We=[],Ge=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"linkProfile",get:function(){return this.navigationService.getSettingsProfile()}},{key:"linkPrivacyZones",get:function(){return this.navigationService.getSettingsPrivacyZones()}},{key:"linkImport",get:function(){return this.navigationService.getSettingsImport()}},{key:"linkInstance",get:function(){return this.navigationService.getSettingsInstance()}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],Ge.prototype,"name",void 0),Ge=Object(p["a"])([Object(d["a"])({components:{MainHeader:te}})],Ge);var Ye=Ge,Je=Ye,Ke=(i("7360"),Object(g["a"])(Je,Ve,We,!1,null,"5d7d2192",null)),Qe=Ke.exports,Xe=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.cmd=null,t.working=!1,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse())}},{key:"onRouteChanged",value:function(){this.load()}},{key:"created",value:function(){this.load()}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.apiService.updateProfile(this.user.username,this.cmd).then((function(){t.load(),G.pushSuccess(t,"Profile saved.")}),(function(e){G.pushError(t,"Sign in process could not be completed.",e)})).finally((function(){t.working=!1})))}},{key:"load",value:function(){var t=this;this.apiService.refreshCurrentUser().then((function(e){t.cmd={displayName:e.displayName}}),(function(e){G.pushError(t,"Could not refresh the current user.",e)}))}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.cmd.displayName||t.push("Display name can not be empty."),this.cmd.displayName.length>100&&t.push("Display name is too long."),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],Xe.prototype,"onUserChanged",null),Object(p["a"])([Object(d["e"])("$route")],Xe.prototype,"onRouteChanged",null),Xe=Object(p["a"])([Object(d["a"])({components:{SettingsPage:Qe,SubHeader:oe,FormInput:fe,AppButton:je}})],Xe);var ti=Xe,ei=ti,ii=(i("541f"),Object(g["a"])(ei,He,Be,!1,null,"7ad1626d",null)),ni=ii.exports,ai=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings-privacy-zones"},[i("settings-page",{attrs:{name:"privacy-zones"}},[i("sub-header",{attrs:{text:"Privacy zones"}}),i("app-button",{staticClass:"button",attrs:{text:"New privacy zone"},on:{click:t.goToNewPrivacyZone}}),t.noPrivacyZones?i("warning-alert",[t._v(" You do not have any privacy zones. ")]):t._e(),t.loading?i("spinner"):t._e(),t.noPrivacyZones?t._e():i("ul",{staticClass:"privacy-zones"},t._l(t.privacyZones,(function(e){return i("li",{key:e.uuid},[i("privacy-zone",{attrs:{zone:e}},[i("router-link",{attrs:{to:t.zoneSettingsLink(e)}},[t._v(" Settings ")])],1)],1)})),0)],1)],1)},ri=[],si=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("alert",{attrs:{kind:"warning"}},[t._t("default")],2)},oi=[],ci=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"alert",class:t.kind},[t._t("default")],2)},ui=[],li=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],li.prototype,"kind",void 0),li=Object(p["a"])([d["a"]],li);var vi,pi=li;(function(t){t["Warning"]="warning"})(vi||(vi={}));var di=pi,fi=(i("3959"),Object(g["a"])(di,ci,ui,!1,null,"7f5dbe0e",null)),hi=fi.exports,bi=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);bi=Object(p["a"])([Object(d["a"])({components:{Alert:hi}})],bi);var mi,yi=bi,gi=yi,Oi=Object(g["a"])(gi,si,oi,!1,null,null,null),ji=Oi.exports,ki=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"privacy-zone"},[t.zone.name?i("div",{staticClass:"name"},[t._v(" "+t._s(t.zone.name)+" ")]):i("div",{staticClass:"name"},[t._v(" Unnamed privacy zone ")]),i("div",{staticClass:"actions"},[t._t("default")],2),i("div",{staticClass:"map"},[i("privacy-zone-map",{attrs:{zone:t.zone,lock:!0}})],1)])},wi=[],Ci=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"privacy-zone-map"},[i("div",{staticClass:"map",attrs:{id:t.zone.uuid}})])},_i=[];i("d81d"),i("25f0");(function(t){t["Primary"]="#16a085",t["Secondary"]="#fe4365"})(mi||(mi={}));var Si=i("5eee"),xi=i("6c77"),Ui=i("83a6"),Pi=i("8682"),Ei=i("f403"),$i=i("ce2c"),Di=i("a2c7"),Ii=i("4cdf"),Ai=i("480c"),zi=i("3e6b"),Mi=i("2ef1"),Fi=i("5831"),Ti=i("076a"),Zi=(i("5bc0"),i("256f")),Ri=i("5bc3"),Ni=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.source=new Fi["a"]({}),t.padding=10,t}return Object(c["a"])(i,[{key:"onZoneUUIDChanged",value:function(){this.recreateMap(),this.setZone(this.zone)}},{key:"onCircleChanged",value:function(){this.setZone(this.zone)}},{key:"onPositionChanged",value:function(){this.setZone(this.zone)}},{key:"mounted",value:function(){this.recreateMap()}},{key:"recreateMap",value:function(){var t=this;this.map&&this.map.setTarget(null),this.map=new Si["a"]({target:this.zone.uuid,layers:[new Ai["a"]({source:new Mi["a"]({attributions:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://a.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})}),new zi["a"]({source:this.source})],view:new Di["a"]({center:Object(Zi["m"])([16.35618,48.2093851],"EPSG:4326","EPSG:3857"),zoom:14,maxZoom:18}),controls:[new Ti["a"]],interactions:this.lock?[]:void 0}),this.map.on("click",(function(e){var i=Object(Zi["m"])(t.map.getCoordinateFromPixel(e.pixel),"EPSG:3857","EPSG:4326"),n={latitude:i[1],longitude:i[0]};t.$emit("position",n)})),this.fitMap()}},{key:"setZone",value:function(t){this.source.clear(),t.position&&t.circle&&t.circle.radius&&t.circle.center&&(this.source.addFeature(this.createPositionFeature(t.position)),this.source.addFeature(this.createCircleFeature(t.circle)),this.fitMap())}},{key:"createPositionFeature",value:function(t){var e=[t.longitude,t.latitude],i=new Ii["a"]({geometry:new Ei["a"](e).transform("EPSG:4326","EPSG:3857")});return i.setStyle([new xi["b"]({image:new $i["a"]({radius:5,fill:new Ui["a"]({color:mi.Primary}),stroke:new Pi["a"]({color:"#ffffff",width:1})})})]),i}},{key:"createCircleFeature",value:function(t){var e=[t.center.longitude,t.center.latitude],i=new Ii["a"]({geometry:Object(Ri["a"])(e,t.radius).transform("EPSG:4326","EPSG:3857")});return i.setStyle([new xi["b"]({fill:new Ui["a"]({color:this.addAlpha(mi.Primary,.2)}),stroke:new Pi["a"]({width:1,color:mi.Primary})})]),i}},{key:"fitMap",value:function(){if(this.lock){var t=this.source.getFeatures();this.map&&t&&t.length>0&&this.map.getView().fit(this.source.getExtent(),{padding:[this.padding,this.padding,this.padding,this.padding]})}}},{key:"addAlpha",value:function(t,e){var i=Math.round(255*Math.min(Math.max(e||1,0),1));return t+i.toString(16).toUpperCase()}},{key:"zoneUUID",get:function(){return this.zone.uuid}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],Ni.prototype,"lock",void 0),Object(p["a"])([Object(d["b"])()],Ni.prototype,"zone",void 0),Object(p["a"])([Object(d["e"])("zoneUUID",{immediate:!0})],Ni.prototype,"onZoneUUIDChanged",null),Object(p["a"])([Object(d["e"])("zone.circle",{immediate:!0})],Ni.prototype,"onCircleChanged",null),Object(p["a"])([Object(d["e"])("zone.position",{immediate:!0})],Ni.prototype,"onPositionChanged",null),Ni=Object(p["a"])([d["a"]],Ni);var Li=Ni,qi=Li,Hi=(i("4f2c"),Object(g["a"])(qi,Ci,_i,!1,null,"3cad7104",null)),Bi=Hi.exports,Vi=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],Vi.prototype,"zone",void 0),Vi=Object(p["a"])([Object(d["a"])({components:{PrivacyZoneMap:Bi}})],Vi);var Wi=Vi,Gi=Wi,Yi=(i("73ce"),Object(g["a"])(Gi,ki,wi,!1,null,"287ae755",null)),Ji=Yi.exports,Ki=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.privacyZones=null,t.navigationService=new H(Object(u["a"])(t)),t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse()),t&&this.loadPrivacyZones(this.user.username)}},{key:"zoneSettingsLink",value:function(t){return this.navigationService.getPrivacyZoneSettings(t.uuid)}},{key:"goToNewPrivacyZone",value:function(){this.$router.push(this.navigationService.getNewPrivacyZone())}},{key:"loadPrivacyZones",value:function(t){var e=this;this.apiService.getUserPrivacyZones(t).then((function(t){e.privacyZones=t.data}),(function(t){G.pushError(e,"Could not retrieve the privacy zones.",t)}))}},{key:"noPrivacyZones",get:function(){return this.privacyZones&&0===this.privacyZones.length}},{key:"loading",get:function(){return!this.privacyZones}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],Ki.prototype,"onUserChanged",null),Ki=Object(p["a"])([Object(d["a"])({components:{SubHeader:oe,FormInput:fe,AppButton:je,WarningAlert:ji,PrivacyZone:Ji,Spinner:et,SettingsPage:Qe}})],Ki);var Qi=Ki,Xi=Qi,tn=(i("55e8"),Object(g["a"])(Xi,ai,ri,!1,null,"7c9ddcbd",null)),en=tn.exports,nn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings-import"},[i("settings-page",{attrs:{name:"import"}},[i("sub-header",{attrs:{text:"Import from Strava"}}),t._v(" In order to import your personal data from Strava please follow the following steps: "),i("ol",[i("li",[t._v(' Navigate to "'),i("a",{attrs:{href:"https://www.strava.com/athlete/delete_your_account"}},[t._v("Account Download and Deletion")]),t._v('" in your Strava settings. ')]),i("li",[t._v(' Follow the instructions specified in the section "Download Request". ')]),i("li",[t._v(" Upload the resulting archive containing your personal data below. ")])]),t._v(' Uploading your archive will only import your activities. For each activity this tool will import its title and route. The visibility of the imported activities will be set to "private". '),i("form",[i("file-upload",{on:{file:t.onFile}}),i("app-button",{attrs:{text:"Import",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1)],1)],1)},an=[],rn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"file-upload",class:{dragging:t.isDragging}},[t.isDragging?i("span",{staticClass:"call-to-action-drop"},[i("i",{staticClass:"fas fa-file-upload"}),t._v(" Drop the file! ")]):t.selectedFile?i("span",{staticClass:"selected-file"},[i("i",{staticClass:"fas fa-file-upload"}),t._v(" "+t._s(t.selectedFile.name)+" ")]):i("span",{staticClass:"call-to-action"},[i("i",{staticClass:"fas fa-file-upload"}),t._v(" Drop a file or click to select it ")]),i("div",{staticClass:"drop-zone",on:{dragover:t.onDragover,dragenter:t.onDragenter,dragleave:t.onDragleave,dragend:t.onDragend,drop:t.onDrop,click:t.onClick}}),i("input",{ref:"input",attrs:{type:"file"},on:{change:t.onFileSelect}})])},sn=[],on=i("54f8"),cn=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.isDragging=!1,t.selectedFile=null,t}return Object(c["a"])(i,[{key:"onDragover",value:function(t){this.isDragging=!0,t.preventDefault()}},{key:"onDragenter",value:function(){this.isDragging=!0}},{key:"onDragleave",value:function(){this.isDragging=!1}},{key:"onDragend",value:function(){this.isDragging=!1}},{key:"onClick",value:function(t){t.preventDefault(),this.input.click()}},{key:"onDrop",value:function(t){this.isDragging=!1,this.handleFiles(t.dataTransfer.files)}},{key:"onFileSelect",value:function(){this.handleFiles(this.input.files)}},{key:"handleFiles",value:function(t){var e,i=Object(on["a"])(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.selectedFile=n,this.$emit("file",n)}}catch(a){i.e(a)}finally{i.f()}}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],cn.prototype,"icon",void 0),Object(p["a"])([Object(d["c"])("input")],cn.prototype,"input",void 0),cn=Object(p["a"])([d["a"]],cn);var un=cn,ln=un,vn=(i("c62f"),Object(g["a"])(ln,rn,sn,!1,null,"a6335a16",null)),pn=vn.exports,dn=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.request={archive:null},t.working=!1,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse())}},{key:"onFile",value:function(t){this.request={archive:t}}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.apiService.importStrava(this.request).then((function(){G.pushSuccess(t,"Import successful."),t.$router.push(t.navigationService.getProfile(t.user.username))}),(function(e){G.pushError(t,"Import failed.",e)})).finally((function(){t.working=!1})))}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.request.archive||t.push("Strava archive is missing."),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],dn.prototype,"onUserChanged",null),dn=Object(p["a"])([Object(d["a"])({components:{SettingsPage:Qe,SubHeader:oe,AppButton:je,FileUpload:pn}})],dn);var fn=dn,hn=fn,bn=(i("69f6"),Object(g["a"])(hn,nn,an,!1,null,"3e2bf793",null)),mn=bn.exports,yn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"settings-instance"},[i("settings-page",{attrs:{name:"instance"}},[i("sub-header",{attrs:{text:"Invitations"}}),t.user&&t.user.administrator?i("invitations"):t._e(),i("sub-header",{attrs:{text:"Users"}}),t.user&&t.user.administrator?i("users"):t._e()],1)],1)},gn=[],On=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"users"},[i("table",[t._m(0),i("tbody",t._l(t.users,(function(e){return i("tr",{key:e.username,staticClass:"user"},[i("td",{staticClass:"username"},[t._v(" "+t._s(e.username)+" ")]),i("td",{staticClass:"role"},[t._v(" "+t._s(t.getRole(e))+" ")]),i("td",{staticClass:"created"},[i("timeago",{attrs:{datetime:e.created}})],1),i("td",{staticClass:"last-seen"},[i("timeago",{attrs:{datetime:e.lastSeen}})],1),i("td",{staticClass:"actions"},[i("v-popover",{attrs:{offset:"16"}},[t.canRemove(e)?i("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Remove this user.",expression:"'Remove this user.'"}]},[i("i",{staticClass:"fas fa-times"})]):t._e(),i("template",{slot:"popover"},[i("p",[t._v(" This action can not be undone, do you wish to proceed? ")]),i("app-button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],attrs:{text:"Confirm"},on:{click:function(i){return t.removeUser(e)}}})],1)],2)],1)])})),0)]),t.users?t._e():i("spinner")],1)},jn=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("th",{staticClass:"username"},[t._v(" Username ")]),i("th",{staticClass:"role"},[t._v(" Role ")]),i("th",{staticClass:"created"},[t._v(" Signed Up ")]),i("th",{staticClass:"last-seen"},[t._v(" Last Seen ")]),i("th",{staticClass:"actions"},[t._v(" Actions ")])])}],kn=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.users=null,t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"mounted",value:function(){this.load()}},{key:"getRole",value:function(t){return t.administrator?"Administrator":"User"}},{key:"canRemove",value:function(t){return t.username!==this.currentUser.username}},{key:"removeUser",value:function(t){var e=this;this.apiService.remove(t.username).then((function(){e.load()}),(function(i){G.pushError(e,"Could not remove the user '".concat(t.username,"'."),i)}))}},{key:"load",value:function(){var t=this;this.users=null,this.apiService.list().then((function(e){t.users=e.data}),(function(e){G.pushError(t,"Could not list the user accounts.",e)}))}},{key:"currentUser",get:function(){return this.$store.state.user}}]),i}(d["d"]);kn=Object(p["a"])([Object(d["a"])({components:{AppButton:je,Spinner:et}})],kn);var wn=kn,Cn=wn,_n=(i("d8b0"),Object(g["a"])(Cn,On,jn,!1,null,"4cfbd87b",null)),Sn=_n.exports,xn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"invitations"},[i("app-button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Create a link containing a one-time token allowing your friend to register an account.",expression:"'Create a link containing a one-time token allowing your friend to register an account.'"}],staticClass:"button",attrs:{text:"Create an invitation link",working:t.working},on:{click:t.createInvitation}}),t.invitationUrl?i("pre",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Click to copy.",expression:"'Click to copy.'"}],staticClass:"token",on:{click:t.copy}},[t._v(t._s(t.invitationUrl))]):t._e()],1)},Un=[],Pn=(i("99af"),function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.working=!1,t.token=null,t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"createInvitation",value:function(){var t=this;this.working=!0,this.apiService.createInvitation().then((function(e){t.token=e.data.token}),(function(e){G.pushError(t,"Generating an invitation failed.",e)})).finally((function(){return t.working=!1}))}},{key:"copy",value:function(){var t=this;navigator.clipboard?navigator.clipboard.writeText(this.invitationUrl).then((function(){G.pushSuccess(t,"The invitation link has been copied.")}),(function(){G.pushError(t,"Copying to clipboard failed.")})):G.pushError(this,"\n                The Clipboard API is not available.\n                Please note that the Clipboard API is only available in secure\n                contexts (websites secured with TLS).\n            ")}},{key:"invitationUrl",get:function(){if(!this.token)return null;var t=window.location;return"".concat(t.protocol,"//").concat(t.host,"/register/").concat(this.token)}}]),i}(d["d"]));Pn=Object(p["a"])([Object(d["a"])({components:{AppButton:je}})],Pn);var En=Pn,$n=En,Dn=(i("487b"),Object(g["a"])($n,xn,Un,!1,null,"0e3e2fb1",null)),In=Dn.exports,An=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse())}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],An.prototype,"onUserChanged",null),An=Object(p["a"])([Object(d["a"])({components:{SubHeader:oe,FormInput:fe,AppButton:je,Users:Sn,Invitations:In,SettingsPage:Qe}})],An);var zn,Mn=An,Fn=Mn,Tn=(i("cc3d"),Object(g["a"])(Fn,yn,gn,!1,null,"75633584",null)),Zn=Tn.exports,Rn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"profile"},[i("div",{staticClass:"wrapper"},[t.user?i("div",[t._m(1),i("h1",[t._v(t._s(t.user.displayName))]),i("h2",[t._v("@"+t._s(t.user.username))])]):i("div",{staticClass:"loading"},[t._m(0)]),t.activities?i("div",[t.activities.activities?t._e():i("div",{staticClass:"no-activities-message"},[t._v(" This user doesn't have any activities. ")]),i("activity-previews",{attrs:{activities:t.activities.activities}}),i("pagination",{attrs:{previous:t.previous,next:t.next}})],1):i("div",[i("spinner")],1)])])},Nn=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fake-content"},[i("div",{staticClass:"picture"},[i("i",{staticClass:"far fa-user-circle"})]),i("h1",[t._v("John Smith")]),i("h2",[t._v("@user")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"picture"},[i("i",{staticClass:"far fa-user-circle"})])}],Ln=function(){function t(){Object(o["a"])(this,t)}return Object(c["a"])(t,[{key:"scrollToTop",value:function(){window.scrollTo(0,0)}}]),t}(),qn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-previews"},t._l(t.activities,(function(t){return i("div",{key:t.uuid,staticClass:"activity"},[i("activity-preview",{attrs:{activity:t}})],1)})),0)},Hn=[],Bn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-preview"},[i("activity-header",{attrs:{activity:t.activity}}),i("router-link",{staticClass:"map-link",attrs:{to:t.location}},[i("route-map",{attrs:{route:t.activity.route,lock:!0}})],1)],1)},Vn=[],Wn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"route-map"},[i("div",{ref:"map-bounding-box",staticClass:"map",attrs:{id:t.route.uuid}})])},Gn=[],Yn=i("8295"),Jn=i("7a09");(function(t){t["CheckeredFlag"]="",t["MapMarker"]=""})(zn||(zn={}));var Kn=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.routeSource=new Fi["a"]({}),t.padding=40,t.lineWidth=3,t.outlineWidth=1,t}return Object(c["a"])(i,[{key:"onRouteChanged",value:function(){this.routeSource.clear(),this.route&&(this.recreateMap(),this.setPoints(this.route.points))}},{key:"mounted",value:function(){var t=this;this.observer=new ResizeObserver((function(){t.recreateMap()})),this.observer.observe(this.mapBoundingBox)}},{key:"beforeDestory",value:function(){this.observer.unobserve(this.mapBoundingBox)}},{key:"recreateMap",value:function(){this.map&&this.map.setTarget(null),this.map=new Si["a"]({target:this.route.uuid,layers:[new Ai["a"]({source:new Mi["a"]({attributions:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://a.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})}),new zi["a"]({source:this.routeSource,style:[new xi["b"]({stroke:new Pi["a"]({color:"#fff",width:this.lineWidth+this.outlineWidth})}),new xi["b"]({stroke:new Pi["a"]({color:mi.Primary,width:this.lineWidth})})]})],view:new Di["a"]({center:[0,0],zoom:0,maxZoom:18}),controls:[new Ti["a"]],interactions:this.lock?[]:void 0}),this.fitMapToRoute()}},{key:"setPoints",value:function(t){var e=t.map((function(t){return[t.position.longitude,t.position.latitude]})),i=new Ii["a"]({geometry:new Jn["a"](e).transform("EPSG:4326","EPSG:3857")});this.routeSource.addFeature(i);var n=new Ii["a"]({geometry:new Ei["a"](e[0]).transform("EPSG:4326","EPSG:3857")});n.setStyle(this.pointStyle(zn.MapMarker)),this.routeSource.addFeature(n);var a=new Ii["a"]({geometry:new Ei["a"](e[e.length-1]).transform("EPSG:4326","EPSG:3857")});a.setStyle(this.pointStyle(zn.CheckeredFlag)),this.routeSource.addFeature(a),this.fitMapToRoute()}},{key:"fitMapToRoute",value:function(){var t=this.routeSource.getFeatures();this.map&&t&&t.length>0&&this.map.getView().fit(t[0].getGeometry(),{padding:[this.padding,this.padding,this.padding,this.padding]})}},{key:"pointStyle",value:function(t){return[new xi["b"]({image:new $i["a"]({radius:10,fill:new Ui["a"]({color:"#fff"}),stroke:new Pi["a"]({color:"#ff0000",width:1})}),text:new Yn["a"]({text:t,font:'900 15px "Font Awesome 5 Free"',fill:new Ui["a"]({color:mi.Secondary}),stroke:new Pi["a"]({color:"#fff",width:1}),textAlign:"center",textBaseline:"bottom",offsetY:10})})]}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],Kn.prototype,"lock",void 0),Object(p["a"])([Object(d["b"])()],Kn.prototype,"route",void 0),Object(p["a"])([Object(d["c"])("map-bounding-box")],Kn.prototype,"mapBoundingBox",void 0),Object(p["a"])([Object(d["e"])("route",{immediate:!0})],Kn.prototype,"onRouteChanged",null),Kn=Object(p["a"])([d["a"]],Kn);var Qn,Xn,ta,ea=Kn,ia=ea,na=(i("f4b0"),Object(g["a"])(ia,Wn,Gn,!1,null,"3f77897b",null)),aa=na.exports,ra=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-header"},[i("div",{staticClass:"avatar"},[i("router-link",{attrs:{to:t.profileLink}},[i("i",{staticClass:"far fa-user-circle"})])],1),i("div",{staticClass:"author"},[i("router-link",{attrs:{to:t.profileLink}},[t._v(" "+t._s(t.activity.user.displayName)+" ")])],1),i("div",{staticClass:"visibility"},[i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.visibilityLabel,expression:"visibilityLabel"}],class:t.visibilityIcon})]),t.hideTitle?t._e():i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.title,expression:"title"}],staticClass:"title"},[t._v(" "+t._s(t.title)+" ")]),i("a",{staticClass:"date"},[i("router-link",{attrs:{to:t.profileLink}},[i("time",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.dateLabel,expression:"dateLabel"}]},[i("timeago",{attrs:{datetime:t.activity.timeStarted}})],1)])],1),i("ul",{staticClass:"details"},[i("li",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Distance.",expression:"'Distance.'"}]},[i("i",{staticClass:"fas fa-route"}),t._v(" "+t._s(t._f("distance")(t.activity.route.distance))+" ")]),i("li",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Time moving.",expression:"'Time moving.'"}]},[i("i",{staticClass:"fas fa-stopwatch"}),t._v(" "+t._s(t._f("duration")(t.activity.route.timeMoving))+" ")])])])},sa=[];function oa(t){switch(t){case Qn.Public:return Xn.Public;case Qn.Unlisted:return Xn.Unlisted;case Qn.Private:return Xn.Private;default:return""}}function ca(t){switch(t){case Qn.Public:return ta.Public;case Qn.Unlisted:return ta.Unlisted;case Qn.Private:return ta.Private;default:return""}}function ua(t){return t?t.title?t.title:"".concat(t.user.displayName,"'s activity"):""}(function(t){t["Public"]="public",t["Unlisted"]="unlisted",t["Private"]="private"})(Qn||(Qn={})),function(t){t["Public"]="fas fa-globe-europe",t["Unlisted"]="fas fa-lock-open",t["Private"]="fas fa-lock"}(Xn||(Xn={})),function(t){t["Public"]="Public",t["Unlisted"]="Unlisted",t["Private"]="Private"}(ta||(ta={}));i("a15b");var la=a["a"].filter("date",(function(t){return t=t.replace("T"," "),t=t.replace("Z"," UTC"),t})),va=a["a"].filter("distance",(function(t){return da(t/1e3,1)+"km"})),pa=a["a"].filter("duration",(function(t){for(var e=["s","m","h","d"],i=[60,60,24],n=[],a=0;a<i.length;a++){var r=t/i[a];n.splice(0,0,[t%i[a],e[a]]),a===i.length-1&&n.splice(0,0,[r,e[a+1]]),t=r}return n.filter((function(t){return t[0]>=1})).filter((function(t,e){return e<2})).map((function(t){return Math.floor(t[0])+t[1]})).join(" ")}));function da(t,e){var i=Math.pow(10,e||0);return Math.round(t*i)/i}var fa=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"visibilityIcon",get:function(){return this.activity&&this.activity.visibility?oa(this.activity.visibility):""}},{key:"visibilityLabel",get:function(){return this.activity&&this.activity.visibility?ca(this.activity.visibility)+".":""}},{key:"title",get:function(){return ua(this.activity)}},{key:"dateLabel",get:function(){return"Activity started on ".concat(la(this.activity.timeStarted)," and ended on ").concat(la(this.activity.timeEnded),".")}},{key:"profileLink",get:function(){return this.navigationService.getProfile(this.activity.user.username)}},{key:"activityLink",get:function(){return this.navigationService.getActivity(this.activity.uuid)}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],fa.prototype,"activity",void 0),Object(p["a"])([Object(d["b"])()],fa.prototype,"hideTitle",void 0),fa=Object(p["a"])([d["a"]],fa);var ha=fa,ba=ha,ma=(i("4bbc"),Object(g["a"])(ba,ra,sa,!1,null,"731aabfa",null)),ya=ma.exports,ga=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"location",get:function(){return this.activity?this.navigationService.getActivity(this.activity.uuid):null}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],ga.prototype,"activity",void 0),ga=Object(p["a"])([Object(d["a"])({components:{RouteMap:aa,ActivityHeader:ya}})],ga);var Oa=ga,ja=Oa,ka=(i("5273"),Object(g["a"])(ja,Bn,Vn,!1,null,"5e965c27",null)),wa=ka.exports,Ca=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],Ca.prototype,"activities",void 0),Ca=Object(p["a"])([Object(d["a"])({components:{ActivityPreview:wa}})],Ca);var _a=Ca,Sa=_a,xa=(i("5a73"),Object(g["a"])(Sa,qn,Hn,!1,null,"4fae07e7",null)),Ua=xa.exports,Pa=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pagination"},[t.previous?i("router-link",{staticClass:"previous button",attrs:{to:t.previous}},[i("i",{staticClass:"fas fa-chevron-left"}),t._v(" Previous ")]):t._e(),i("div",{staticClass:"filler"}),t.next?i("router-link",{staticClass:"next button",attrs:{to:t.next}},[t._v(" Next "),i("i",{staticClass:"fas fa-chevron-right"})]):t._e()],1)},Ea=[],$a=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);Object(p["a"])([Object(d["b"])()],$a.prototype,"previous",void 0),Object(p["a"])([Object(d["b"])()],$a.prototype,"next",void 0),$a=Object(p["a"])([d["a"]],$a);var Da=$a,Ia=Da,Aa=(i("1b80"),Object(g["a"])(Ia,Pa,Ea,!1,null,"068c4d0e",null)),za=Aa.exports,Ma=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.user=null,t.activities=null,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t.scrollService=new Ln,t}return Object(c["a"])(i,[{key:"onRouteChanged",value:function(){var t=this.getUsernameFromRoute(),e=this.$route.query.before,i=this.$route.query.after;this.loadUser(t),this.loadActivities(t,this.asString(e),this.asString(i)),this.scrollService.scrollToTop()}},{key:"loadUser",value:function(t){var e=this;this.user&&this.user.username===t||this.apiService.getUser(t).then((function(t){e.user=t.data}),(function(t){G.pushError(e,"Could not retrieve the user.",t)}))}},{key:"loadActivities",value:function(t,e,i){var n=this;this.activities=null,this.apiService.getUserActivities(t,e,i).then((function(t){n.activities=t.data}),(function(t){G.pushError(n,"Could not retrieve the activities.",t)}))}},{key:"getUsernameFromRoute",value:function(){return this.$route.params.username}},{key:"asString",value:function(t){return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:null}},{key:"previous",get:function(){return this.activities&&this.activities.hasPrevious?this.navigationService.getProfileWithBefore(this.getUsernameFromRoute(),this.activities.activities[0].uuid):null}},{key:"next",get:function(){return this.activities&&this.activities.hasNext?this.navigationService.getProfileWithAfter(this.getUsernameFromRoute(),this.activities.activities[this.activities.activities.length-1].uuid):null}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("$route",{immediate:!0})],Ma.prototype,"onRouteChanged",null),Ma=Object(p["a"])([Object(d["a"])({components:{ActivityPreviews:Ua,Spinner:et,Pagination:za}})],Ma);var Fa=Ma,Ta=Fa,Za=(i("cf25"),Object(g["a"])(Ta,Rn,Nn,!1,null,"4058735a",null)),Ra=Za.exports,Na=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"new-activity"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"New activity"}}),i("form",[i("div",{staticClass:"title-row"},[i("form-input",{attrs:{type:"text",placeholder:"Title",icon:"fas fa-pen",maxlength:"50"},model:{value:t.request.title,callback:function(e){t.$set(t.request,"title",e)},expression:"request.title"}}),i("form-radio",{attrs:{values:t.visibilityValues},model:{value:t.request.visibility,callback:function(e){t.$set(t.request,"visibility",e)},expression:"request.visibility"}})],1),i("file-upload",{on:{file:t.onFile}}),i("app-button",{attrs:{text:"Save",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1)],1)])},La=[],qa=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-radio"},[i("dropdown",{ref:"dropdown",scopedSlots:t._u([{key:"trigger",fn:function(){return[i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.currentSelection.tooltip,expression:"currentSelection.tooltip"}],staticClass:"trigger"},[i("i",{staticClass:"selection",class:t.currentSelection.icon}),i("i",{staticClass:"fas fa-caret-down call-to-action"})])]},proxy:!0},{key:"content",fn:function(){return t._l(t.values,(function(e){return i("dropdown-element",{key:e.value},[i("div",{on:{click:function(i){return t.select(e.value)}}},[i("a",{staticClass:"dropdown-option"},[i("i",{class:e.icon}),t._v(" "+t._s(e.label)+" ")])])])}))},proxy:!0}])})],1)},Ha=[],Ba=(i("ddb0"),function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return Object(c["a"])(i,[{key:"select",value:function(t){this.$emit("input",t),this.dropdown.close()}},{key:"currentSelection",get:function(){var t,e=Object(on["a"])(this.values);try{for(e.s();!(t=e.n()).done;){var i=t.value;if(this.value===i.value)return i}}catch(n){e.e(n)}finally{e.f()}return null}}]),i}(d["d"]));Object(p["a"])([Object(d["b"])()],Ba.prototype,"value",void 0),Object(p["a"])([Object(d["b"])()],Ba.prototype,"values",void 0),Object(p["a"])([Object(d["c"])("dropdown")],Ba.prototype,"dropdown",void 0),Ba=Object(p["a"])([Object(d["a"])({components:{Dropdown:ct,DropdownElement:ht}})],Ba);var Va=Ba,Wa=Va,Ga=(i("021a"),Object(g["a"])(Wa,qa,Ha,!1,null,"490816a8",null)),Ya=Ga.exports,Ja=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.request={title:"",routeFile:null,visibility:Qn.Private},t.working=!1,t.visibilityValues=[{value:Qn.Public,icon:Xn.Public,label:"Public",tooltip:"This activity will be publicly visible."},{value:Qn.Unlisted,icon:Xn.Unlisted,label:"Unlisted",tooltip:"This activity will not be hidden but accessible via a direct link."},{value:Qn.Private,icon:Xn.Private,label:"Private",tooltip:"This activity will be visible only to you."}],t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse())}},{key:"onFile",value:function(t){this.request={title:this.request.title,visibility:this.request.visibility,routeFile:t}}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.apiService.newActivity(this.request).then((function(e){t.$router.push(t.navigationService.getActivity(e.data.activityUUID))}),(function(e){G.pushError(t,"Failed to create a new activity.",e)})).finally((function(){t.working=!1})))}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];this.request.routeFile||t.push("Route file is missing.");var e=50;return this.request.title.length>e&&t.push("Title can not be longer than ".concat(e," characters.")),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],Ja.prototype,"onUserChanged",null),Ja=Object(p["a"])([Object(d["a"])({components:{MainHeader:te,FormInput:fe,AppButton:je,FileUpload:pn,FormRadio:Ya}})],Ja);var Ka=Ja,Qa=Ka,Xa=(i("40bb"),Object(g["a"])(Qa,Na,La,!1,null,"6aa99cb0",null)),tr=Xa.exports,er=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:t.title}},[t.activity?i("main-header-actions",[t.canEditActivity?i("main-header-action",[i("router-link",{attrs:{to:t.activitySettingsLocation}},[t._v(" Settings ")])],1):t._e()],1):t._e()],1),t.activity?i("activity-header",{attrs:{activity:t.activity,hideTitle:!0}}):t._e()],1),i("div",{staticClass:"map-container"},[i("div",{ref:"map-wrapper",staticClass:"map-wrapper"},[t.activity?i("route-map",{staticClass:"map",attrs:{route:t.activity.route}}):t._e()],1)])])},ir=[],nr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"main-header-actions"},[t._t("default")],2)},ar=[],rr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);rr=Object(p["a"])([d["a"]],rr);var sr=rr,or=sr,cr=(i("f085"),Object(g["a"])(or,nr,ar,!1,null,"3ab98c76",null)),ur=cr.exports,lr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"main-header-action"},[t._t("default")],2)},vr=[],pr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return i}(d["d"]);pr=Object(p["a"])([d["a"]],pr);var dr=pr,fr=dr,hr=(i("40bf"),Object(g["a"])(fr,lr,vr,!1,null,"0648f5ea",null)),br=hr.exports,mr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.activityUUID=null,t.activity=null,t.navigationService=new H(Object(u["a"])(t)),t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onRouteChanged",value:function(){this.load()}},{key:"created",value:function(){this.load()}},{key:"mounted",value:function(){var t=this;this.observer=new ResizeObserver((function(){t.rescaleMap()})),this.observer.observe(this.mapWrapperElement),window.addEventListener("resize",(function(){t.rescaleMap()})),this.rescaleMap()}},{key:"beforeDestory",value:function(){this.observer.unobserve(this.mapWrapperElement)}},{key:"load",value:function(){var t=this;this.activityUUID=this.getActivityUUIDFromRoute(),this.apiService.getActivity(this.activityUUID).then((function(e){t.activity=e.data,t.rescaleMap()}),(function(e){G.pushError(t,"Could not retrieve the activity.",e)}))}},{key:"getActivityUUIDFromRoute",value:function(){return this.$route.params.activityUUID}},{key:"rescaleMap",value:function(){if(this.mapWrapperElement){var t=window.innerHeight,e=this.mapWrapperElement.getBoundingClientRect().top-window.scrollY,i=t-e;this.mapWrapperElement.style.height=i<500?"500px":i+"px"}}},{key:"title",get:function(){return ua(this.activity)}},{key:"user",get:function(){return this.$store.state.user}},{key:"activitySettingsLocation",get:function(){return this.navigationService.getActivitySettings(this.activityUUID)}},{key:"route",get:function(){return this.activity?this.activity.route:null}},{key:"canEditActivity",get:function(){return this.user&&this.user.username&&this.user.username===this.activity.user.username}}]),i}(d["d"]);Object(p["a"])([Object(d["c"])("map-wrapper")],mr.prototype,"mapWrapperElement",void 0),Object(p["a"])([Object(d["e"])("$route")],mr.prototype,"onRouteChanged",null),mr=Object(p["a"])([Object(d["a"])({components:{Spinner:et,MainHeader:te,MainHeaderActions:ur,MainHeaderAction:br,RouteMap:aa,ActivityHeader:ya}})],mr);var yr=mr,gr=yr,Or=(i("687e"),Object(g["a"])(gr,er,ir,!1,null,"239f462a",null)),jr=Or.exports,kr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-settings"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Activity settings"}},[t.activityUUID?i("main-header-actions",[i("main-header-action",[i("router-link",{attrs:{to:t.activityLocation}},[t._v(" Back ")])],1)],1):t._e()],1),i("form",[i("ul",{staticClass:"area actions"},[i("li",[i("label",{staticClass:"primary",attrs:{for:"title-input"}},[t._v(" Title ")]),i("div",{staticClass:"secondary"},[t._v(" Name your activity. ")]),i("form-input",{staticClass:"action",attrs:{id:"title-input",placeholder:"Title",maxlength:t.maxTitleLength},model:{value:t.request.title,callback:function(e){t.$set(t.request,"title",e)},expression:"request.title"}})],1),i("li",[i("label",{staticClass:"primary",attrs:{for:"title-input"}},[t._v(" Visibility ")]),i("div",{staticClass:"secondary"},[t._v(" Specify who can see your activity. ")]),i("form-radio",{staticClass:"action",attrs:{values:t.visibilityValues},model:{value:t.request.visibility,callback:function(e){t.$set(t.request,"visibility",e)},expression:"request.visibility"}})],1),i("li",[i("app-button",{attrs:{text:"Save",working:t.workingEdit},on:{click:t.submitEdit}})],1)])]),i("sub-header",{attrs:{text:"Danger zone"}}),i("ul",{staticClass:"area actions danger"},[i("li",[i("div",{staticClass:"primary"},[t._v(" Delete this activity ")]),i("div",{staticClass:"secondary"},[t._v(" Deleting an activity can not be undone. ")]),i("div",{staticClass:"action"},[i("app-button",{staticClass:"danger",attrs:{text:"Delete this activity"},on:{click:t.initiateDeletion}})],1),t.deletionInitiated?i("div",{staticClass:"below confirm-deletion"},[i("div",{staticClass:"message"},[t._v(" Are you sure? You will not be able to recover this activity. ")]),i("div",{staticClass:"buttons"},[i("app-button",{staticClass:"danger",attrs:{text:"Confirm",working:t.workingDelete},on:{click:t.submitDelete}}),i("app-button",{attrs:{text:"Cancel"},on:{click:t.cancelDeletion}})],1)]):t._e()])])],1)])},wr=[],Cr=function t(){Object(o["a"])(this,t)},_r=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.activityUUID=null,t.activity=null,t.request=new Cr,t.workingEdit=!1,t.workingDelete=!1,t.deletionInitiated=!1,t.maxTitleLength=50,t.visibilityValues=[{value:Qn.Public,icon:Xn.Public,label:"Public",tooltip:"This activity will be publicly visible."},{value:Qn.Unlisted,icon:Xn.Unlisted,label:"Unlisted",tooltip:"This activity will not be hidden but accessible via a direct link."},{value:Qn.Private,icon:Xn.Private,label:"Private",tooltip:"This activity will be visible only to you."}],t.navigationService=new H(Object(u["a"])(t)),t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onRouteChanged",value:function(){this.load()}},{key:"created",value:function(){this.load()}},{key:"submitEdit",value:function(){var t=this;this.formValid&&(this.workingEdit=!0,this.apiService.editActivity(this.activityUUID,this.request).then((function(){G.pushSuccess(t,"Activity saved.")}),(function(e){G.pushError(t,"Failed to update the activity.",e)})).finally((function(){t.workingEdit=!1})))}},{key:"submitDelete",value:function(){var t=this;this.workingDelete=!0,this.apiService.deleteActivity(this.activityUUID).then((function(){G.pushSuccess(t,"Activity deleted."),t.$router.replace(t.navigationService.getBrowse())}),(function(e){G.pushError(t,"Failed to delete the activity.",e)})).finally((function(){t.workingDelete=!1}))}},{key:"cancelDeletion",value:function(){this.deletionInitiated=!1}},{key:"initiateDeletion",value:function(){this.deletionInitiated=!0}},{key:"load",value:function(){var t=this;this.activityUUID=this.getActivityUUIDFromRoute(),this.apiService.getActivity(this.activityUUID).then((function(e){t.activity=e.data,t.request={title:t.activity.title,visibility:t.activity.visibility}}),(function(e){G.pushError(t,"Could not retrieve the activity.",e)}))}},{key:"getActivityUUIDFromRoute",value:function(){return this.$route.params.activityUUID}},{key:"activityLocation",get:function(){return this.navigationService.getActivity(this.activityUUID)}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.request.title.length>this.maxTitleLength&&t.push("Title can not be longer than ".concat(this.maxTitleLength," characters.")),t}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("$route")],_r.prototype,"onRouteChanged",null),_r=Object(p["a"])([Object(d["a"])({components:{Spinner:et,MainHeader:te,SubHeader:oe,MainHeaderActions:ur,MainHeaderAction:br,RouteMap:aa,ActivityHeader:ya,FormInput:fe,FormRadio:Ya,AppButton:je}})],_r);var Sr=_r,xr=Sr,Ur=(i("c276"),Object(g["a"])(xr,kr,wr,!1,null,"2e6d1370",null)),Pr=Ur.exports,Er=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"new-privacy-zone"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"New privacy zone"}}),i("privacy-zone-form",{attrs:{value:t.zone},on:{input:t.onInput}}),i("app-button",{attrs:{text:"Save",disabled:!t.formValid,working:t.working},on:{click:t.submit}})],1)])},$r=[],Dr=(i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"privacy-zone-form"},[i("form-input",{attrs:{type:"text",placeholder:"Name",icon:"fas fa-pen",maxlength:"50",value:t.value.name},on:{input:t.onName}}),i("form-slider",{staticClass:"radius-slider",attrs:{min:"100",max:"5000",step:"100",label:t.radiusSliderLabel,value:t.value.circle.radius},on:{input:t.onRadius}}),i("div",{staticClass:"map"},[i("privacy-zone-map",{attrs:{zone:t.value},on:{position:t.onMapPosition}})],1)],1)}),Ir=[],Ar=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-slider"},[t.icon?i("div",{staticClass:"icon"},[i("i",{class:t.icon})]):t._e(),i("input",{attrs:{type:"range",min:t.min,max:t.max,step:t.step},domProps:{value:t.value},on:{input:t.emitValue}}),i("div",{staticClass:"label",style:{left:t.labelLeft}},[i("div",{staticClass:"text-wrapper"},[t._v(" "+t._s(t.labelString)+" ")])])])},zr=[],Mr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return Object(c["a"])(i,[{key:"emitValue",value:function(t){this.$emit("input",parseInt(t.target.value,10))}},{key:"labelString",get:function(){return this.label?this.label(this.value):this.value}},{key:"labelLeft",get:function(){var t=this.max-this.min,e=this.value-this.min;return e/t*100+"%"}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],Mr.prototype,"min",void 0),Object(p["a"])([Object(d["b"])()],Mr.prototype,"max",void 0),Object(p["a"])([Object(d["b"])()],Mr.prototype,"step",void 0),Object(p["a"])([Object(d["b"])()],Mr.prototype,"value",void 0),Object(p["a"])([Object(d["b"])()],Mr.prototype,"icon",void 0),Object(p["a"])([Object(d["b"])()],Mr.prototype,"label",void 0),Mr=Object(p["a"])([d["a"]],Mr);var Fr=Mr,Tr=Fr,Zr=(i("fb9e"),Object(g["a"])(Tr,Ar,zr,!1,null,"152b373e",null)),Rr=Zr.exports;function Nr(t){var e=3.14*t/180;return 111132.92-559.82*Math.cos(2*e)+1.175*Math.cos(4*e)-.0023*Math.cos(6*e)}function Lr(t){var e=3.14*t/180;return 111412.84*Math.cos(e)-93.5*Math.cos(3*e)+.118*Math.cos(5*e)}function qr(t){return t>90?90:t<-90?-90:t}function Hr(t){while(t>180)t-=180;while(t<0)t+=180;return t}function Br(t,e,i,n){var a=t*Math.PI/180,r=e*Math.PI/180,s=i*Math.PI/180,o=n*Math.PI/180,c=6378100,u=Vr(s-a)+Math.cos(a)*Math.cos(s)*Vr(o-r);return 2*c*Math.asin(Math.sqrt(u))}function Vr(t){return Math.pow(Math.sin(t/2),2)}var Wr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){return Object(o["a"])(this,i),e.apply(this,arguments)}return Object(c["a"])(i,[{key:"radiusSliderLabel",value:function(t){return"".concat(t," meters")}},{key:"onName",value:function(t){this.value.name=t,this.emitZone()}},{key:"onRadius",value:function(t){this.value.circle.radius=t,this.positionIsWithinCircle(this.value)||this.randomizeCircleCenter(this.value),this.emitZone()}},{key:"onMapPosition",value:function(t){this.value.position=t,this.randomizeCircleCenter(this.value),this.emitZone()}},{key:"emitZone",value:function(){var t={uuid:this.value.uuid,name:this.value.name,circle:this.value.circle,position:this.value.position};this.$emit("input",t)}},{key:"randomizeCircleCenter",value:function(t){var e=Nr(t.position.latitude),i=Lr(t.position.latitude);do{var n=t.circle.radius/e,a=t.circle.radius/i,r=qr(t.position.latitude-n+2*n*Math.random()),s=Hr(t.position.longitude-a+2*a*Math.random());t.circle.center={latitude:r,longitude:s}}while(!this.positionIsWithinCircle(t))}},{key:"positionIsWithinCircle",value:function(t){var e=.9;return this.distanceToCircleCenter(t)<e*t.circle.radius}},{key:"distanceToCircleCenter",value:function(t){return Br(t.circle.center.latitude,t.circle.center.longitude,t.position.latitude,t.position.longitude)}}]),i}(d["d"]);Object(p["a"])([Object(d["b"])()],Wr.prototype,"value",void 0),Wr=Object(p["a"])([Object(d["a"])({components:{PrivacyZoneMap:Bi,FormInput:fe,FormSlider:Rr}})],Wr);var Gr=Wr,Yr=Gr,Jr=(i("5e6c"),Object(g["a"])(Yr,Dr,Ir,!1,null,"9bea097a",null)),Kr=Jr.exports,Qr=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.zone={uuid:"made-up-uuid",name:"",circle:{center:null,radius:1e3},position:null},t.working=!1,t.apiService=new N(Object(u["a"])(t)),t.navigationService=new H(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onUserChanged",value:function(t){null===t&&this.$router.replace(this.navigationService.getBrowse())}},{key:"onInput",value:function(t){this.zone=t}},{key:"submit",value:function(){var t=this;this.formValid&&(this.working=!0,this.apiService.newPrivacyZone({name:this.zone.name,position:this.zone.position,circle:this.zone.circle}).then((function(){t.$router.push(t.navigationService.getSettingsPrivacyZones())}),(function(e){G.pushError(t,"Failed to create a new privacy zone.",e)})).finally((function(){t.working=!1})))}},{key:"formValid",get:function(){return!this.formErrors||0===this.formErrors.length}},{key:"formErrors",get:function(){var t=[];return this.zone.circle.radius||t.push("Missing circle radius."),this.zone.circle.center||t.push("Missing circle center."),this.zone.position||t.push("Missing position."),t}},{key:"user",get:function(){return this.$store.state.user}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("user",{immediate:!0})],Qr.prototype,"onUserChanged",null),Qr=Object(p["a"])([Object(d["a"])({components:{Spinner:et,MainHeader:te,AppButton:je,PrivacyZoneForm:Kr}})],Qr);var Xr=Qr,ts=Xr,es=(i("a526"),Object(g["a"])(ts,Er,$r,!1,null,"69c58dbe",null)),is=es.exports,ns=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-settings"},[i("div",{staticClass:"wrapper"},[i("main-header",{attrs:{text:"Privacy zone settings"}},[i("main-header-actions",[i("main-header-action",[i("router-link",{attrs:{to:t.privacyZonesLink}},[t._v(" Back ")])],1)],1)],1),i("sub-header",{attrs:{text:"Danger zone"}}),i("ul",{staticClass:"area actions danger"},[i("li",[i("div",{staticClass:"primary"},[t._v(" Delete this privacy zone ")]),i("div",{staticClass:"secondary"},[t._v(" Deleting a privacy zone can not be undone. ")]),i("div",{staticClass:"action"},[i("app-button",{staticClass:"danger",attrs:{text:"Delete this privacy zone"},on:{click:t.initiateDeletion}})],1),t.deletionInitiated?i("div",{staticClass:"below confirm-deletion"},[i("div",{staticClass:"message"},[t._v(" Are you sure? You will not be able to recover this privacy zone. ")]),i("div",{staticClass:"buttons"},[i("app-button",{staticClass:"danger",attrs:{text:"Confirm",working:t.workingDelete},on:{click:t.submitDelete}}),i("app-button",{attrs:{text:"Cancel"},on:{click:t.cancelDeletion}})],1)]):t._e()])])],1)])},as=[],rs=function(t){Object(l["a"])(i,t);var e=Object(v["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.privacyZoneUUID=null,t.workingDelete=!1,t.deletionInitiated=!1,t.navigationService=new H(Object(u["a"])(t)),t.apiService=new N(Object(u["a"])(t)),t}return Object(c["a"])(i,[{key:"onRouteChanged",value:function(){this.load()}},{key:"created",value:function(){this.load()}},{key:"submitDelete",value:function(){var t=this;this.workingDelete=!0,this.apiService.deletePrivacyZone(this.privacyZoneUUID).then((function(){G.pushSuccess(t,"Privacy zone deleted."),t.$router.replace(t.navigationService.getSettingsPrivacyZones())}),(function(e){G.pushError(t,"Failed to delete the privacy zone.",e)})).finally((function(){t.workingDelete=!1}))}},{key:"cancelDeletion",value:function(){this.deletionInitiated=!1}},{key:"initiateDeletion",value:function(){this.deletionInitiated=!0}},{key:"load",value:function(){this.privacyZoneUUID=this.getPrivacyZoneUUIDFromRoute()}},{key:"getPrivacyZoneUUIDFromRoute",value:function(){return this.$route.params.privacyZoneUUID}},{key:"privacyZonesLink",get:function(){return this.navigationService.getSettingsPrivacyZones()}}]),i}(d["d"]);Object(p["a"])([Object(d["e"])("$route")],rs.prototype,"onRouteChanged",null),rs=Object(p["a"])([Object(d["a"])({components:{MainHeader:te,SubHeader:oe,MainHeaderActions:ur,MainHeaderAction:br,AppButton:je}})],rs);var ss=rs,os=ss,cs=(i("9848"),Object(g["a"])(os,ns,as,!1,null,"3e4724d8",null)),us=cs.exports;a["a"].use(Tt["a"]);var ls=new Tt["a"]({mode:"history",base:"/",routes:[{path:"/setup",name:"setup",component:xe},{path:"/settings/profile",name:"settings-profile",component:ni},{path:"/settings/privacy-zones",name:"settings-privacy-zones",component:en},{path:"/settings/import",name:"settings-import",component:mn},{path:"/settings/instance",name:"settings-instance",component:Zn},{path:"/settings",name:"settings",redirect:{name:"settings-profile"}},{path:"/login",name:"login",component:ze},{path:"/register",name:"register",component:qe},{path:"/register/:token",name:"register-using-invitation",component:qe},{path:"/user/:username",name:"profile",component:Ra},{path:"/new-activity",name:"new-activity",component:tr},{path:"/activity/:activityUUID",name:"activity",component:jr},{path:"/activity/:activityUUID/settings",name:"activity-settings",component:Pr},{path:"/new-privacy-zone",name:"new-privacy-zone",component:is},{path:"/privacy-zone/:privacyZoneUUID/settings",name:"privacy-zone-settings",component:us},{path:"/",name:"browse",component:Bt},{path:"*",redirect:{name:"browse"}}]}),vs=i("e37d"),ps=i("86823");a["a"].use(vs["a"]),a["a"].use(ps["a"],{}),a["a"].config.productionTip=!1,new a["a"]({router:ls,store:z,render:function(t){return t(Ft)},filters:{distanceFilter:va,durationFilter:pa,dateFilter:la}}).$mount("#app")},cf25:function(t,e,i){"use strict";var n=i("b5d4"),a=i.n(n);a.a},d364:function(t,e,i){},d8b0:function(t,e,i){"use strict";var n=i("1d00"),a=i.n(n);a.a},d8fc:function(t,e,i){"use strict";var n=i("6065"),a=i.n(n);a.a},db29:function(t,e,i){},e10b:function(t,e,i){},e2de:function(t,e,i){"use strict";var n=i("8384"),a=i.n(n);a.a},e7df:function(t,e,i){},eaaa:function(t,e,i){},ee62:function(t,e,i){"use strict";var n=i("7181"),a=i.n(n);a.a},eee0:function(t,e,i){},f085:function(t,e,i){"use strict";var n=i("58ad"),a=i.n(n);a.a},f4b0:function(t,e,i){"use strict";var n=i("8946"),a=i.n(n);a.a},fa0b:function(t,e,i){},fb9e:function(t,e,i){"use strict";var n=i("c0fa"),a=i.n(n);a.a},fd9b:function(t,e,i){"use strict";var n=i("18c9"),a=i.n(n);a.a},fde6:function(t,e,i){},fecf:function(t,e,i){}});